[["feuilles-attaquées.html", "Chapitre 2 Feuilles attaquées 2.1 Les données 2.2 Visualisation boxplots 2.3 Détection des observations aberrantes extrêmes 2.4 LANOVA 2.5 Évolution du nombre de feuilles attaquées selon la méthode au cours du temps", " Chapitre 2 Feuilles attaquées Définir ce quon entend pas feuilles attaquées  Évaluer si le nombre de feuilles ayant subi des attaques dinsectes diffèrent significativement selon la méthode de contrôle appliquée. Jeu de données kam.csv qui contient différentes mesures dont les nombres de feuilles attaquées, comptés en 4 séances. On pourrait également évaluer si les différentes méthodes ont des intensités dattaques sur les feuilles significativement différentes avec le temps. On comparera les effets des méthodes séance par séance, puis à laide dune figure on appréciera sil y a une évolution en fonction du temps. 2.1 Les données df &lt;- read_csv(&quot;data/kam.csv&quot;) df &lt;- df %&gt;% mutate(id = rep(1:8, 4), .before = 1, seance = factor(seance), methode = factor(methode, levels = c(&quot;Temoin&quot;, &quot;Filet-anti-insectes&quot;, &quot;Lutte-mecanique&quot;, &quot;Cigogne-50-EC&quot;)), bloc = factor(bloc)) %&gt;% select(id, seance, bloc, methode, nfa) %&gt;% mutate(id = factor(id)) Le tableau est déjà structuré en format long en Excel. Jai ajouté un identifiant (id) pour les échantillons des seances. Afficher quelques lignes aléatoires par methode pour visualiser le dataframe : set.seed(123) df %&gt;% sample_n_by(seance, methode, size = 1) ## # A tibble: 16 x 5 ## id seance bloc methode nfa ## &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt; ## 1 1 Semaine 1 1 Temoin 5 ## 2 2 Semaine 1 1 Filet-anti-insectes 2 ## 3 3 Semaine 1 1 Lutte-mecanique 2 ## 4 8 Semaine 1 2 Cigogne-50-EC 4 ## 5 1 Semaine 2 1 Temoin 30 ## 6 6 Semaine 2 2 Filet-anti-insectes 16 ## 7 7 Semaine 2 2 Lutte-mecanique 23 ## 8 8 Semaine 2 2 Cigogne-50-EC 5 ## 9 1 Semaine 3 1 Temoin 22 ## 10 2 Semaine 3 1 Filet-anti-insectes 15 ## 11 7 Semaine 3 2 Lutte-mecanique 12 ## 12 8 Semaine 3 2 Cigogne-50-EC 10 ## 13 5 Semaine 4 2 Temoin 12 ## 14 2 Semaine 4 1 Filet-anti-insectes 9 ## 15 7 Semaine 4 2 Lutte-mecanique 12 ## 16 4 Semaine 4 1 Cigogne-50-EC 16 2.2 Visualisation boxplots bxp &lt;- ggplot(df, aes(x = methode, y = nfa, fill = methode)) + geom_boxplot() + facet_grid(seance ~ .) + ylab(&quot;Nombre de feuilles attaquées&quot;) + #theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + theme_bw() bxp Il y a des variations notables entre les méthodes et également dune seance à lautre. 2.3 Détection des observations aberrantes extrêmes df_out &lt;- df %&gt;% group_by(seance, methode) %&gt;% identify_outliers(nfa) df_out ## [1] seance methode id bloc nfa is.outlier is.extreme ## &lt;0 rows&gt; (or 0-length row.names) =&gt; Pas dobservation aberrante extrême pour toutes les seances. 2.4 LANOVA Vu le nombre dobservations (trop faible nombre de répétitions) et le type de données (décomptes), je pense que les conditions de lANOVA ordinaire (surtout la normalité de la distribution), ne sont pas reunies. En pareil cas selon mes lectures sur les forums de discussion en la matière, il est plus indiqué dutiliser la distribution de Poisson ou un test de Chi-carré. Jutilise donc le modèle linéaire général glm() de type Poisson pour dresser le tableau de lANOVA. 2.4.1 Séance 1 (1ère semaine de mesure) 2.4.1.1 Le modèle df1 &lt;- df %&gt;% filter(seance == &quot;Semaine 1&quot;) lm1 &lt;- glm(nfa ~ methode, data = df1, family = poisson) Anova(lm1) ## Analysis of Deviance Table (Type II tests) ## ## Response: nfa ## LR Chisq Df Pr(&gt;Chisq) ## methode 18.433 3 0.000358 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 La p-value &lt; 0.05 =&gt; différence très significative entre les effets des méthodes de contrôle sur le nombre de feuilles attaquées à la Semaine 1. 2.4.1.2 Comparaisons par paires La fonction emmeans() du package du même nom, computes estimated marginal means (EMMs) for specified factors or factor combinations in a linear model; and optionally, comparisons or contrasts among them. EMMs are also known as least-squares means. The following obtains estimates and associated t statistics comparing each of these with the average of the others. En dernière colonne jajoute des numéros pour identifier les paires de comparaisons (les contrastes). pwc_lm1 = emmeans::emmeans(lm1, ~ methode) (cm1 &lt;- pairs(pwc_lm1) %&gt;% as_tibble() %&gt;% mutate(no_contrast = c(&quot;Contraste 1&quot;, &quot;Contraste 2&quot;, &quot;Contraste 3&quot;, &quot;Contraste 4&quot;, &quot;Contraste 5&quot;, &quot;Contraste 6&quot;))) ## # A tibble: 6 x 7 ## contrast estimate SE df z.ratio p.value no_contrast ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Temoin - (Filet-anti-insecte~ 0.742 0.384 Inf 1.93 0.215 Contraste 1 ## 2 Temoin - (Lutte-mecanique) 2.35 0.740 Inf 3.18 0.00809 Contraste 2 ## 3 Temoin - (Cigogne-50-EC) 0.647 0.372 Inf 1.74 0.304 Contraste 3 ## 4 (Filet-anti-insectes) - (Lut~ 1.61 0.775 Inf 2.08 0.160 Contraste 4 ## 5 (Filet-anti-insectes) - (Cig~ -0.0953 0.437 Inf -0.218 0.996 Contraste 5 ## 6 (Lutte-mecanique) - (Cigogne~ -1.70 0.769 Inf -2.22 0.118 Contraste 6 Cette classification établie une différence significative entre les effets de la méthode Témoin et de la lutte mécanique (Contraste 2). plot(pairs(pwc_lm1)) NB Pour vous faciliter la lecture de la figure ci-dessus, les éléments dune paire comparée ne sont significativement différents que lorsque la bande grisée (le point noir est la moyenne et la bande limite lintervalle de confiance de la moyenne), ne croise pas la ligne imaginaire verticale passant par zéro. Je calcule les moyennes et écart-types et jajoute une colonne à la main pour constituer les groupes. (cm1_moy &lt;- summarySE(df1, measurevar = &quot;nfa&quot;, groupvars = &quot;methode&quot;) %&gt;% data.table::setorder(-nfa)) ## methode N nfa sd se ci ## 1 Temoin 2 10.5 7.778175 5.5 69.88413 ## 4 Cigogne-50-EC 2 5.5 2.121320 1.5 19.05931 ## 2 Filet-anti-insectes 2 5.0 4.242641 3.0 38.11861 ## 3 Lutte-mecanique 2 1.0 1.414214 1.0 12.70620 (cm1_moy &lt;- cm1_moy %&gt;% mutate(groups = c(&quot;a&quot;, &quot;ab&quot;, &quot;ab&quot;, &quot;b&quot;))) ## methode N nfa sd se ci groups ## 1 Temoin 2 10.5 7.778175 5.5 69.88413 a ## 4 Cigogne-50-EC 2 5.5 2.121320 1.5 19.05931 ab ## 2 Filet-anti-insectes 2 5.0 4.242641 3.0 38.11861 ab ## 3 Lutte-mecanique 2 1.0 1.414214 1.0 12.70620 b =&gt; Du moment où cette méthode ici est faite à la main, très facile de se tromper. Toujours se référer à la figure et au tableau des contrastes. Sous forme graphique  ggplot(data = cm1_moy, mapping = aes(x = methode, y = nfa)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.5) + #geom_errorbar(aes(ymin = nfa - ci, ymax = nfa + ci), width =.1) + geom_text(aes(label = groups), vjust = -0.5, size = 4) + #ylim(0, 13) + xlab(&quot;Méthodes&quot;) + ylab(&quot;Nombre de feuilles attaquées&quot;) + #theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + theme_bw() =&gt; Deux barres partageant les mêmes lettres sont des méthodes dont les effets ne sont pas significativement différents. La méthode danalyse sera la même pour toutes les semaines sauf pour la hauteur des plant, variable quantitative continue, pour laquelle on vérifiera les hypothèses de lANOVA pour lappliquer. Il se peut quil y ait moins de commentaires désormais  2.4.2 Séance 2 (2è semaine de mesure) 2.4.2.1 Le modèle df2 &lt;- df %&gt;% filter(seance == &quot;Semaine 2&quot;) (df2_out &lt;- df2 %&gt;% identify_outliers(nfa)) ## [1] id seance bloc methode nfa is.outlier is.extreme ## &lt;0 rows&gt; (or 0-length row.names) lm2 &lt;- glm(nfa ~ methode, data = df2, family = poisson) Anova(lm2) ## Analysis of Deviance Table (Type II tests) ## ## Response: nfa ## LR Chisq Df Pr(&gt;Chisq) ## methode 36.247 3 6.641e-08 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 La p-value &lt; 0.05 =&gt; différence très significative entre les effets des méthodes de contrôle sur le nombre de feuilles attaquées à la Semaine 2. 2.4.2.2 Comparaisons par paires pwc_lm2 = emmeans::emmeans(lm2, ~ methode) (cm2 &lt;- pairs(pwc_lm2) %&gt;% as_tibble() %&gt;% mutate(no_contrast = c(&quot;Contraste 1&quot;, &quot;Contraste 2&quot;, &quot;Contraste 3&quot;, &quot;Contraste 4&quot;, &quot;Contraste 5&quot;, &quot;Contraste 6&quot;))) ## # A tibble: 6 x 7 ## contrast estimate SE df z.ratio p.value no_contrast ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Temoin - (Filet-anti-insect~ 0.480 0.250 Inf 1.92 2.19e-1 Contraste 1 ## 2 Temoin - (Lutte-mecanique) -0.405 0.199 Inf -2.04 1.75e-1 Contraste 2 ## 3 Temoin - (Cigogne-50-EC) 1.03 0.301 Inf 3.42 3.47e-3 Contraste 3 ## 4 (Filet-anti-insectes) - (Lu~ -0.885 0.233 Inf -3.80 8.44e-4 Contraste 4 ## 5 (Filet-anti-insectes) - (Ci~ 0.550 0.324 Inf 1.70 3.25e-1 Contraste 5 ## 6 (Lutte-mecanique) - (Cigogn~ 1.44 0.287 Inf 5.00 3.51e-6 Contraste 6 Cette classification établie une différence significative entre les effets pour les contrastes 3, 4 et 6. plot(pairs(pwc_lm2)) Moyennes et cart-type et ajout dune colonne à la main pour constituer les groupes. (cm2_moy &lt;- summarySE(df2, measurevar = &quot;nfa&quot;, groupvars = &quot;methode&quot;) %&gt;% data.table::setorder(-nfa)) ## methode N nfa sd se ci ## 3 Lutte-mecanique 2 31.5 12.020815 8.5 108.00274 ## 1 Temoin 2 21.0 12.727922 9.0 114.35584 ## 2 Filet-anti-insectes 2 13.0 4.242641 3.0 38.11861 ## 4 Cigogne-50-EC 2 7.5 3.535534 2.5 31.76551 (cm2_moy &lt;- cm2_moy %&gt;% mutate(groups = c(&quot;a&quot;, &quot;b&quot;, &quot;bc&quot;, &quot;c&quot;))) ## methode N nfa sd se ci groups ## 3 Lutte-mecanique 2 31.5 12.020815 8.5 108.00274 a ## 1 Temoin 2 21.0 12.727922 9.0 114.35584 b ## 2 Filet-anti-insectes 2 13.0 4.242641 3.0 38.11861 bc ## 4 Cigogne-50-EC 2 7.5 3.535534 2.5 31.76551 c Sous forme graphique  ggplot(data = cm2_moy, mapping = aes(x = methode, y = nfa)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.5) + #geom_errorbar(aes(ymin = nfa - ci, ymax = nfa + ci), width =.1) + geom_text(aes(label = groups), vjust = -0.5, size = 4) + #ylim(0, 13) + xlab(&quot;Méthodes&quot;) + ylab(&quot;Nombre de feuilles attaquées&quot;) + #theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + theme_bw() 2.4.3 Séance 3 (3è semaine de mesure) 2.4.3.1 Le modèle df3 &lt;- df %&gt;% filter(seance == &quot;Semaine 3&quot;) (df3_out &lt;- df3 %&gt;% identify_outliers(nfa)) ## # A tibble: 1 x 7 ## id seance bloc methode nfa is.outlier is.extreme ## &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt; ## 1 5 Semaine 3 2 Temoin 34 TRUE TRUE =&gt; Une observation supposée extrême, mais je ne lexclue pas. lm3 &lt;- glm(nfa ~ methode, data = df3, family = poisson) Anova(lm3) ## Analysis of Deviance Table (Type II tests) ## ## Response: nfa ## LR Chisq Df Pr(&gt;Chisq) ## methode 21.825 3 7.094e-05 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 La p-value &lt; 0.05 =&gt; différence très significative entre les effets des méthodes de contrôle sur le nombre de feuilles attaquées à la Semaine 3. 2.4.3.2 Comparaisons par paires pwc_lm3 = emmeans::emmeans(lm3, ~ methode) (cm3 &lt;- pairs(pwc_lm3) %&gt;% as_tibble() %&gt;% mutate(no_contrast = c(&quot;Contraste 1&quot;, &quot;Contraste 2&quot;, &quot;Contraste 3&quot;, &quot;Contraste 4&quot;, &quot;Contraste 5&quot;, &quot;Contraste 6&quot;))) ## # A tibble: 6 x 7 ## contrast estimate SE df z.ratio p.value no_contrast ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Temoin - (Filet-anti-insecte~ 0.890 0.248 Inf 3.59 0.00186 Contraste 1 ## 2 Temoin - (Lutte-mecanique) 0.730 0.234 Inf 3.11 0.00999 Contraste 2 ## 3 Temoin - (Cigogne-50-EC) 0.934 0.252 Inf 3.71 0.00117 Contraste 3 ## 4 (Filet-anti-insectes) - (Lut~ -0.160 0.284 Inf -0.565 0.942 Contraste 4 ## 5 (Filet-anti-insectes) - (Cig~ 0.0445 0.298 Inf 0.149 0.999 Contraste 5 ## 6 (Lutte-mecanique) - (Cigogne~ 0.205 0.287 Inf 0.713 0.892 Contraste 6 plot(pairs(pwc_lm3)) Cette classification établie une différence significative entre les effets des autres méthodes et le Témoin (contrastes 1, 2 et 3). Moyennes et cart-type et ajout dune colonne à la main pour constituer les groupes. (cm3_moy &lt;- summarySE(df3, measurevar = &quot;nfa&quot;, groupvars = &quot;methode&quot;) %&gt;% data.table::setorder(-nfa)) ## methode N nfa sd se ci ## 1 Temoin 2 28.0 8.485281 6.0 76.23723 ## 3 Lutte-mecanique 2 13.5 2.121320 1.5 19.05931 ## 2 Filet-anti-insectes 2 11.5 4.949747 3.5 44.47172 ## 4 Cigogne-50-EC 2 11.0 1.414214 1.0 12.70620 (cm3_moy &lt;- cm3_moy %&gt;% mutate(groups = c(&quot;a&quot;, &quot;bc&quot;, &quot;bc&quot;, &quot;c&quot;))) ## methode N nfa sd se ci groups ## 1 Temoin 2 28.0 8.485281 6.0 76.23723 a ## 3 Lutte-mecanique 2 13.5 2.121320 1.5 19.05931 bc ## 2 Filet-anti-insectes 2 11.5 4.949747 3.5 44.47172 bc ## 4 Cigogne-50-EC 2 11.0 1.414214 1.0 12.70620 c Sous forme graphique  ggplot(data = cm3_moy, mapping = aes(x = methode, y = nfa)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.5) + #geom_errorbar(aes(ymin = nfa - ci, ymax = nfa + ci), width =.1) + geom_text(aes(label = groups), vjust = -0.5, size = 4) + #ylim(0, 13) + xlab(&quot;Méthodes&quot;) + ylab(&quot;Nombre de feuilles attaquées&quot;) + #theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + theme_bw() 2.4.4 Séance 4 (4è semaine de mesure) 2.4.4.1 Le modèle df4 &lt;- df %&gt;% filter(seance == &quot;Semaine 4&quot;) (df4_out &lt;- df4 %&gt;% identify_outliers(nfa)) ## # A tibble: 1 x 7 ## id seance bloc methode nfa is.outlier is.extreme ## &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt; ## 1 8 Semaine 4 2 Cigogne-50-EC 20 TRUE FALSE =&gt; Une observation supposée aberrante seulement, je ne lexclue pas. lm4 &lt;- glm(nfa ~ methode, data = df4, family = poisson) Anova(lm4) ## Analysis of Deviance Table (Type II tests) ## ## Response: nfa ## LR Chisq Df Pr(&gt;Chisq) ## methode 7.5027 3 0.05749 . ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 La p-value &gt; 0.05 =&gt; pas de différence significative entre les effets des méthodes de contrôle sur le nombre de feuilles attaquées à la Semaine 4. 2.4.4.2 Comparaisons par paires pwc_lm4 = emmeans::emmeans(lm4, ~ methode) (cm4 &lt;- pairs(pwc_lm4) %&gt;% as_tibble() %&gt;% mutate(no_contrast = c(&quot;Contraste 1&quot;, &quot;Contraste 2&quot;, &quot;Contraste 3&quot;, &quot;Contraste 4&quot;, &quot;Contraste 5&quot;, &quot;Contraste 6&quot;))) ## # A tibble: 6 x 7 ## contrast estimate SE df z.ratio p.value no_contrast ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Temoin - (Filet-anti-insecte~ 0.288 0.312 Inf 0.923 0.793 Contraste 1 ## 2 Temoin - (Lutte-mecanique) 0.182 0.303 Inf 0.602 0.931 Contraste 2 ## 3 Temoin - (Cigogne-50-EC) -0.405 0.264 Inf -1.54 0.414 Contraste 3 ## 4 (Filet-anti-insectes) - (Lut~ -0.105 0.325 Inf -0.324 0.988 Contraste 4 ## 5 (Filet-anti-insectes) - (Cig~ -0.693 0.289 Inf -2.40 0.0768 Contraste 5 ## 6 (Lutte-mecanique) - (Cigogne~ -0.588 0.279 Inf -2.11 0.151 Contraste 6 plot(pairs(pwc_lm4)) Pas de différence significative pour tous les contrastes. Moyennes et cart-type et ajout dune colonne à la main pour constituer les groupes (ici on attribue la même lettre). (cm4_moy &lt;- summarySE(df4, measurevar = &quot;nfa&quot;, groupvars = &quot;methode&quot;) %&gt;% data.table::setorder(-nfa)) ## methode N nfa sd se ci ## 4 Cigogne-50-EC 2 18 2.828427 2 25.41241 ## 1 Temoin 2 12 0.000000 0 0.00000 ## 3 Lutte-mecanique 2 10 2.828427 2 25.41241 ## 2 Filet-anti-insectes 2 9 0.000000 0 0.00000 (cm4_moy &lt;- cm4_moy %&gt;% mutate(groups = c(&quot;a&quot;, &quot;a&quot;, &quot;a&quot;, &quot;a&quot;))) ## methode N nfa sd se ci groups ## 4 Cigogne-50-EC 2 18 2.828427 2 25.41241 a ## 1 Temoin 2 12 0.000000 0 0.00000 a ## 3 Lutte-mecanique 2 10 2.828427 2 25.41241 a ## 2 Filet-anti-insectes 2 9 0.000000 0 0.00000 a Sous forme graphique  ggplot(data = cm4_moy, mapping = aes(x = methode, y = nfa)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.5) + #geom_errorbar(aes(ymin = nfa - ci, ymax = nfa + ci), width =.1) + geom_text(aes(label = groups), vjust = -0.5, size = 4) + #ylim(0, 13) + xlab(&quot;Méthodes&quot;) + ylab(&quot;Nombre de feuilles attaquées&quot;) + #theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + theme_bw() 2.5 Évolution du nombre de feuilles attaquées selon la méthode au cours du temps 2.5.1 Sommaire df_ic &lt;- summarySE(df, measurevar = &quot;nfa&quot;, groupvars = c(&quot;seance&quot;, &quot;methode&quot;), na.rm = TRUE) df_ic ## seance methode N nfa sd se ci ## 1 Semaine 1 Temoin 2 10.5 7.778175 5.5 69.88413 ## 2 Semaine 1 Filet-anti-insectes 2 5.0 4.242641 3.0 38.11861 ## 3 Semaine 1 Lutte-mecanique 2 1.0 1.414214 1.0 12.70620 ## 4 Semaine 1 Cigogne-50-EC 2 5.5 2.121320 1.5 19.05931 ## 5 Semaine 2 Temoin 2 21.0 12.727922 9.0 114.35584 ## 6 Semaine 2 Filet-anti-insectes 2 13.0 4.242641 3.0 38.11861 ## 7 Semaine 2 Lutte-mecanique 2 31.5 12.020815 8.5 108.00274 ## 8 Semaine 2 Cigogne-50-EC 2 7.5 3.535534 2.5 31.76551 ## 9 Semaine 3 Temoin 2 28.0 8.485281 6.0 76.23723 ## 10 Semaine 3 Filet-anti-insectes 2 11.5 4.949747 3.5 44.47172 ## 11 Semaine 3 Lutte-mecanique 2 13.5 2.121320 1.5 19.05931 ## 12 Semaine 3 Cigogne-50-EC 2 11.0 1.414214 1.0 12.70620 ## 13 Semaine 4 Temoin 2 12.0 0.000000 0.0 0.00000 ## 14 Semaine 4 Filet-anti-insectes 2 9.0 0.000000 0.0 0.00000 ## 15 Semaine 4 Lutte-mecanique 2 10.0 2.828427 2.0 25.41241 ## 16 Semaine 4 Cigogne-50-EC 2 18.0 2.828427 2.0 25.41241 2.5.2 Visualisation ggplot(df_ic, aes(x = seance, y = nfa, colour = methode, group = methode)) + geom_line(size = 1) + geom_point(size = 2) + ylab(&quot;Nombre de feuilles attaquées&quot;) + theme_bw() Tendance difficile à exploiter. Nous savons par les analyses pour chaque seance plus haut, que Semaine 1 : différences deffet Semaine 2 : différences deffet Semaine 3 : différences deffet Semaine 4 : pas de différences deffet Puisque les données ne répondent pas aux conditions pour évaluer les effets des méthodes au cours du temps, on négligera leffet des méthodes pour évaluer globalement leffet du temps. On pourrait se demander si les nombres de feuilles attaquées, comptées sur lensemble des méthodes, sont significativement différents dune seance à lautre (cest-à-dire avec le temps). 2.5.3 Effet du temps 2.5.3.1 boxplots, facteur temps bxp &lt;- ggplot(df, aes(x = seance, y = nfa)) + geom_boxplot() bxp 2.5.3.2 Valeurs aberrantes, facteur temps df &lt;- df %&gt;% mutate(id2 = 1:nrow(.), .before = 1) df_out &lt;- df %&gt;% group_by(seance) %&gt;% identify_outliers(nfa) %&gt;% select(id2, seance, bloc, methode, is.outlier, is.extreme) df_out ## # A tibble: 3 x 6 ## id2 seance bloc methode is.outlier is.extreme ## &lt;int&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;lgl&gt; &lt;lgl&gt; ## 1 5 Semaine 1 2 Temoin TRUE FALSE ## 2 21 Semaine 3 2 Temoin TRUE TRUE ## 3 32 Semaine 4 2 Cigogne-50-EC TRUE FALSE Une observation témoin est classée aberrante extrême pour la Semaine 3. Pas exclue. #df &lt;- df %&gt;% filter(id2 != ...) 2.5.3.3 Homogénéité des variances et ANOVA, facteur temps Les autres conditions ont déjà été vérifiées. lm &lt;- anova_test(data = df, dv = nfa, # dependant variable, num wid = id, # identificateur de cas/échantillon (facteur) within = seance) # facteur de groupement intra-sujets get_anova_table(lm) ## ANOVA Table (type III tests) ## ## Effect DFn DFd F p p&lt;.05 ges ## 1 seance 3 21 3.782 0.026 * 0.296 2.5.3.4 Comparaisons par paires, facteur temps lmo &lt;- lm(nfa ~ seance, data = df) pwc_lmo = emmeans::emmeans(lmo, ~ seance) (cmo &lt;- pairs(pwc_lmo) %&gt;% as_tibble() %&gt;% mutate(no_contrast = c(&quot;Contraste 1&quot;, &quot;Contraste 2&quot;, &quot;Contraste 3&quot;, &quot;Contraste 4&quot;, &quot;Contraste 5&quot;, &quot;Contraste 6&quot;))) ## # A tibble: 6 x 7 ## contrast estimate SE df t.ratio p.value no_contrast ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Semaine 1 - Semaine 2 -12.7 3.98 28 -3.20 0.0167 Contraste 1 ## 2 Semaine 1 - Semaine 3 -10.5 3.98 28 -2.64 0.0610 Contraste 2 ## 3 Semaine 1 - Semaine 4 -6.75 3.98 28 -1.70 0.344 Contraste 3 ## 4 Semaine 2 - Semaine 3 2.25 3.98 28 0.566 0.941 Contraste 4 ## 5 Semaine 2 - Semaine 4 6.00 3.98 28 1.51 0.446 Contraste 5 ## 6 Semaine 3 - Semaine 4 3.75 3.98 28 0.943 0.782 Contraste 6 tph &lt;- df %&gt;% pairwise_t_test(nfa ~ seance, paired = TRUE, p.adjust.method = &quot;bonferroni&quot;) tph %&gt;% select(group1, group2, p, p.adj, p.adj.signif) ## # A tibble: 6 x 5 ## group1 group2 p p.adj p.adj.signif ## &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 Semaine 1 Semaine 2 0.041 0.244 ns ## 2 Semaine 1 Semaine 3 0.002 0.013 * ## 3 Semaine 1 Semaine 4 0.018 0.106 ns ## 4 Semaine 2 Semaine 3 0.663 1 ns ## 5 Semaine 2 Semaine 4 0.283 1 ns ## 6 Semaine 3 Semaine 4 0.315 1 ns =&gt; Cest la p-value qui nous intéresse et elle est &lt; 0.05 pour certains contrates. Les 2 précédents codes ont des sorties différentes ! 2.5.3.5 Boxplots avec p-values tph &lt;- tph %&gt;% add_xy_position(x = &quot;seance&quot;) ggboxplot(df, x = &quot;seance&quot;, y = &quot;nfa&quot;) + stat_pvalue_manual(tph) + labs(subtitle = get_test_label(lm, detailed = TRUE), caption = get_pwc_label(tph)) "]]
